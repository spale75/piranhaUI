DELIMITER ;;
CREATE FUNCTION `DATETIME_MOD`(dt DATETIME, modulo INTEGER UNSIGNED) RETURNS datetime
BEGIN

IF modulo = 0 THEN RETURN dt; END IF;
RETURN FROM_UNIXTIME( UNIX_TIMESTAMP(dt) - ( UNIX_TIMESTAMP(dt) % modulo ) );
END ;;
DELIMITER ;

